{"version":3,"sources":["uni-app:///main.js","webpack:////Users/zhuwenlong/Desktop/uniappSys/wyy0131-uni-app实战视频点播app小程序/fe-uniapp-video/pages/detail-video/detail-video.vue?207b","webpack:////Users/zhuwenlong/Desktop/uniappSys/wyy0131-uni-app实战视频点播app小程序/fe-uniapp-video/pages/detail-video/detail-video.vue?3588","webpack:////Users/zhuwenlong/Desktop/uniappSys/wyy0131-uni-app实战视频点播app小程序/fe-uniapp-video/pages/detail-video/detail-video.vue?8e92","webpack:////Users/zhuwenlong/Desktop/uniappSys/wyy0131-uni-app实战视频点播app小程序/fe-uniapp-video/pages/detail-video/detail-video.vue?7287","uni-app:///pages/detail-video/detail-video.vue"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","components","mediaList","fPopup","data","id","activeIndex","tabIndex","tabBars","name","src","poster","detail","category_id","cover","created_time","danmu_count","desc","duration","play_count","title","user","username","nickname","avatar","videos","scrollH","hot","comments","followStatus","favaStatus","content","reply_id","reply_user","fensCount","filters","formatTime","onLoad","uni","icon","delta","token","noJump","toast","console","showCancel","success","event","params","mounted","videoCTX","computed","user_id","methods","getUserInfo","getComments","stop","changeTab","openPopup","hidePopup","openComment","doFollow","follow_id","doFava","video_id","sendComment","reply_user_id","changeVideo","setTimeout","openUserSpace","url"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,oBAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAyH;AACzH;AACgE;AACL;;;AAG3D;AACmN;AACnN,gBAAgB,iNAAU;AAC1B,EAAE,kFAAM;AACR,EAAE,uFAAM;AACR,EAAE,gGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,2FAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACtBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AC5BA;AAAA;AAAA;AAAA;AAAy1B,CAAgB,0yBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;ACyI72B;AACA;AAAA;AAAA;AAAA;EAAA;IAAA;EAAA;AAAA;AAAA;EAAA;IAAA;EAAA;AAAA;AACA;AAAA,eACA;EACAC;IACAC;IACAC;EACA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;QACAC;MACA;QACAA;MACA;MACAC;MACAC;MACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAb;QACAc;QACAC;QACAC;UACAhB;UACAiB;UACAC;UACAC;QACA;MACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MAEAC;MACAC;MACAC;QACA5B;QACAI;MACA;MACAyB;IACA;EACA;EACAC;IACAC;MACA;IACA;EACA;EACAC;IAAA;IACA;IACA;IAEA;MACAC;QACAlB;QACAmB;MACA;MACA;QACAC;MACA;IACA;IAEA;IAEA;MACAC;MACAC;MACAC;IACA;MACAC;MACA;MACA;MACA;MACA;MAEA;QACAN;UACAlB;UACAW;UACAc;UACAC;YACAR;cACAE;YACA;UACA;QACA;MACA;MAEA;MAEA;MAEAF;QACAS;QACAC;UACAvB;UACAnB;UACAK;QACA;MACA;MAEA;MACA;MAEA;MAEA;IACA;EACA;EACAsC;IACAC;EACA;EACAC,4BACA;IACAC;MACA;IACA;EACA,GACA;EACAC;IACAC;MAAA;MACA;QACA;MACA;IACA;IACAC;MAAA;MACA;QACA;QACAX;MACA;IACA;IACAY;IACA;IACAC;MACA;IACA;IACA;IACAC;MACA;IACA;IACAC;MACA;IACA;IACAC,oCAIA;MAAA,IAJA5B;MAAA;QACA3B;QACAiB;QACAC;MACA;MACA;MACA;QACAlB;QACAI;MACA;MACA;MACA;IACA;IACA;IACAoD;MAAA;MACA;MACA;MACA;QACAC;MACA;QACArB;MACA;QACA;QACAH;UACAlB;UACAmB;QACA;QACAK;MACA;QACAA;MACA;IACA;IACA;IACAmB;MAAA;MACA;QACAC;MACA;QACAvB;MACA;QACA;QACAH;UACAlB;UACAmB;QACA;MACA;IACA;IACA;IACA0B;MAAA;MACA;QACA;UACA7C;UACAmB;QACA;MACA;MACA;QACAR;QACAiC;QACAhC;QACAkC;MACA;QACAtB;QACA;QACAN;UACAlB;UACAmB;QACA;QACA;MACA;IACA;IACA4B;MACAjB;MAEA;MACA;MAGAkB;QACAlB;MACA;IAWA;IACAmB;MACA/B;QACAgC;MACA;IACA;EACA;AACA;AAAA,2B","file":"pages/detail-video/detail-video.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/detail-video/detail-video.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./detail-video.vue?vue&type=template&id=7f168334&\"\nvar renderjs\nimport script from \"./detail-video.vue?vue&type=script&lang=js&\"\nexport * from \"./detail-video.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/detail-video/detail-video.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./detail-video.vue?vue&type=template&id=7f168334&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.tabIndex === 0 ? _vm.videos.length : null\n  var l0 = !(_vm.tabIndex === 0)\n    ? _vm.__map(_vm.comments, function (item, index) {\n        var $orig = _vm.__get_orig(item)\n        var f0 = _vm._f(\"formatTime\")(item.created_time)\n        return {\n          $orig: $orig,\n          f0: f0,\n        }\n      })\n    : null\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        l0: l0,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./detail-video.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./detail-video.vue?vue&type=script&lang=js&\"","<template>\n\t<view style=\"line-height: 1;overflow-y: hidden;\">\r\n\t\t<!-- #ifndef APP-PLUS -->\r\n\t\t<video :src=\"src\" :poster=\"poster\" style=\"height: 225px;width: 750rpx;\" controls id=\"myVideo\"></video>\r\n\t\t<!-- #endif -->\r\n\t\t<scroll-view scroll-y=\"true\" :style=\"'height:'+scrollH+'px;'\">\r\n\t\t\t<view class=\"border-bottom border-light-secondary flex align-stretch bg-white\" style=\"height: 80rpx;position: fixed;left: 0;right: 0;z-index: 100;\">\r\n\t\t\t\t<view class=\"flex-1 flex align-center justify-center\"\r\n\t\t\t\tv-for=\"(item,index) in tabBars\" :key=\"index\"\r\n\t\t\t\t@click=\"changeTab(index)\">\r\n\t\t\t\t\t<text class=\"font py-1\" \r\n\t\t\t\t\t:class=\"tabIndex === index ? 'text-main border-main':''\"\r\n\t\t\t\t\t:style=\"tabIndex === index ? 'border-bottom: 5rpx solid;' : ''\">{{item.name}}</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view style=\"height: 80rpx;\"></view>\r\n\t\t\t\r\n\t\t\t<!-- 简介 -->\r\n\t\t\t<view v-if=\"tabIndex === 0\" class=\"animated fadeIn fast\">\r\n\t\t\t\t<view class=\"py-2 px-3 flex align-center\">\r\n\t\t\t\t\t<image @click=\"openUserSpace\" :src=\"detail.user.avatar || '/static/demo/6.jpg'\" style=\"width: 80rpx;height: 80rpx;\" class=\"mr-3 rounded-circle\"></image>\r\n\t\t\t\t\t<view class=\"flex flex-column\">\r\n\t\t\t\t\t\t<text class=\"text-main font-md\">{{detail.user.nickname || detail.user.username}}</text>\r\n\t\t\t\t\t\t<text class=\"font-sm text-muted\" style=\"line-height: 1;\">{{fensCount}} 粉丝</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"flex align-center justify-center rounded bg-main text-white py-1 px-2 ml-auto\" hover-class=\"bg-main-hover\" @click=\"doFollow\" v-if=\" detail.user.id !== user_id \">\r\n\t\t\t\t\t\t<text class=\"font\">{{ followStatus ? '已关注' : '关注' }}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"font-md px-3\">{{detail.title}}</view>\r\n\t\t\t\t<view class=\"flex align-center justify-between text-muted px-3\">\r\n\t\t\t\t\t<view class=\"flex align-center\">\r\n\t\t\t\t\t\t<text class=\"iconfont iconbofangshu font-md mr-1\"></text>\r\n\t\t\t\t\t\t<text class=\"font-sm\">{{detail.play_count}}</text>\r\n\t\t\t\t\t\t<text class=\"iconfont icondanmushu font-md mx-1\"></text>\r\n\t\t\t\t\t\t<text class=\"font-sm\">{{detail.danmu_count}}</text>\r\n\t\t\t\t\t\t<text class=\"font-sm ml-1\">{{detail.created_time}}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"flex align-center justify-center rounded bg-main text-white py-1 px-2 ml-auto\" hover-class=\"bg-main-hover\" @click=\"doFava\">\r\n\t\t\t\t\t\t<text class=\"font-sm\">{{ favaStatus ? '已收藏' : '收藏' }}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<!-- 滚动 -->\r\n\t\t\t\t<view class=\"py-3 border-top border-bottom border-light-secondary\">\r\n\t\t\t\t\t<view class=\"flex align-center px-3\">\r\n\t\t\t\t\t\t<text class=\"font-md\">选集</text>\r\n\t\t\t\t\t\t<view class=\"flex align-center text-muted ml-auto\"\r\n\t\t\t\t\t\t@click=\"openPopup\">\r\n\t\t\t\t\t\t\t共{{videos.length}}集 <text class=\"iconfont iconjinru ml-1\"></text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<scroll-view scroll-x=\"true\" class=\"scroll-row mt-2\">\r\n\t\t\t\t\t\t<view v-for=\"(item,index) in videos\" :key=\"index\" class=\"scroll-row-item rounded border ml-2 p-2 \" :class=\"activeIndex === index ? 'text-main border-main' : 'text-muted border-light-secondary'\" style=\"width: 340rpx;\" @click=\"changeVideo(item,index)\">\r\n\t\t\t\t\t\t\t<text class=\"font\">第 {{ index + 1 }} 集</text>\r\n\t\t\t\t\t\t\t<view class=\"font-md text-ellipsis\">{{ item.title }}</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</scroll-view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"f-list\">\r\n\t\t\t\t\t<media-list v-for=\"(item,index) in hot\" \r\n\t\t\t\t\t:key=\"index\"\r\n\t\t\t\t\t:item=\"item\" :index=\"index\"></media-list>\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t</view>\r\n\t\t\t<!-- 评论 -->\r\n\t\t\t<view v-else class=\"animated fadeIn fast px-3 py-1\">\r\n\t\t\t\t<view class=\"uni-comment-list\" v-for=\"(item,index) in comments\" :key=\"index\">\r\n\t\t\t\t\t<view class=\"uni-comment-face\">\r\n\t\t\t\t\t\t<image :src=\"item.send_user.avatar || '/static/demo/6.jpg'\" style=\"width: 80rpx;height: 80rpx;\" class=\"rounded-circle\"></image>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"uni-comment-body\">\r\n\t\t\t\t\t\t<view class=\"uni-comment-top\">\r\n\t\t\t\t\t\t\t<text class=\"font text-main\">{{item.send_user.nickname || item.send_user.username}}</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"uni-comment-date\">\r\n\t\t\t\t\t\t\t<text class=\"font-sm text-muted\">{{ item.created_time | formatTime }}</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"uni-comment-content\" @click=\"openComment(item.id,item.send_user)\">{{item.content}}</view>\r\n\t\t\t\t\t\t<!-- 回复 -->\r\n\t\t\t\t\t\t<view class=\"flex flex-wrap p-2 bg-light rounded\" v-for=\"(item2,index2) in item.comments\" :key=\"index2\">\r\n\t\t\t\t\t\t\t<text class=\"font text-main\">{{item2.send_user.nickname || item2.send_user.username}}</text>\r\n\t\t\t\t\t\t\t<text class=\"font text-dark\">回复</text>\r\n\t\t\t\t\t\t\t<text class=\"font text-main\">{{item2.reply_user.nickname || item2.reply_user.username}}：</text>\r\n\t\t\t\t\t\t\t<text @click=\"openComment(item.id,item2.send_user)\">{{item2.content}}</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t\r\n\t\t\t\t<view class=\"position-fixed flex align-center justify-center bg-main rounded-circle animated fast\" hover-class=\"bg-main-hover pulse\" style=\"width: 120rpx;height: 120rpx;right: 50rpx;bottom: 50rpx;\" @click=\"openComment(0)\">\r\n\t\t\t\t\t<text class=\"text-white iconfont iconjia\"></text>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t</scroll-view>\r\n\t\t\r\n\t\t<f-popup ref=\"popup\">\r\n\t\t\t<view class=\"position-absolute bottom-0 left-0 right-0 bg-white animated faster fadeIn\" @click.stop=\"stop\">\r\n\t\t\t\t<view style=\"height: 600rpx;\">\r\n\t\t\t\t\t<view class=\"flex align-center\">\r\n\t\t\t\t\t\t<text class=\"font-md ml-3\">选集</text>\r\n\t\t\t\t\t\t<view class=\"flex align-center justify-center ml-auto\" style=\"width: 80rpx;height: 80rpx;\" hover-class=\"bg-light\" @click=\"hidePopup\">\r\n\t\t\t\t\t\t\t<text class=\"iconfont iconguanbi text-muted\"></text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<scroll-view scroll-y=\"true\" style=\"height: 520rpx;\">\r\n\t\t\t\t\t\t<view class=\"flex flex-wrap\">\r\n\t\t\t\t\t\t\t<view style=\"width: 50%;box-sizing: border-box;\" v-for=\"(item,index) in videos\" :key=\"index\" class=\"p-2\">\r\n\t\t\t\t\t\t\t\t<view class=\"rounded border p-2 \" :class=\"activeIndex === index ? 'text-main border-main' : 'text-muted border-light-secondary'\" @click=\"changeVideo(item,index)\">\r\n\t\t\t\t\t\t\t\t\t<text class=\"font\">第 {{index+1}} 集</text>\r\n\t\t\t\t\t\t\t\t\t<view class=\"font-md text-ellipsis\">{{item.title}}</view>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</scroll-view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</f-popup>\r\n\t\t\r\n\t\t<f-popup ref=\"comment\">\r\n\t\t\t<view class=\"position-absolute bottom-0 left-0 right-0 bg-white animated faster fadeIn\" @click.stop=\"stop\">\r\n\t\t\t\t<view style=\"height: 100rpx;\" class=\"flex align-center px-3\">\r\n\t\t\t\t\t<input type=\"text\" v-model=\"content\" class=\"bg-light rounded mr-3 px-2 flex-1\" style=\"height: 60rpx;\" :placeholder=\"reply_user.id ? '回复 @'+reply_user.name : '说一句话吧'\"/>\r\n\t\t\t\t\t<view class=\"flex align-center justify-center rounded bg-main text-white py-1 px-2 ml-auto\" hover-class=\"bg-main-hover\" @click=\"sendComment\">\r\n\t\t\t\t\t\t<text class=\"font\">发送</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</f-popup>\r\n\t\t\n\t</view>\n</template>\n\n<script>\r\n\timport mediaList from '@/components/common/media-list.vue';\r\n\timport fPopup from '@/components/common/f-popup.vue';\r\n\timport $T from '@/pages/common/time.js';\r\n\timport { mapState } from 'vuex';\r\n\tlet videoCTX = null\n\texport default {\r\n\t\tcomponents: {\r\n\t\t\tmediaList,\r\n\t\t\tfPopup\r\n\t\t},\n\t\tdata() {\n\t\t\treturn {\r\n\t\t\t\tid:0,\r\n\t\t\t\tactiveIndex:0,\r\n\t\t\t\ttabIndex:0,\r\n\t\t\t\ttabBars:[{\r\n\t\t\t\t\tname:\"简介\"\r\n\t\t\t\t},{\r\n\t\t\t\t\tname:\"评论\"\r\n\t\t\t\t}],\r\n\t\t\t\tsrc:\"\",\r\n\t\t\t\tposter:\"\",\n\t\t\t\tdetail:{\r\n\t\t\t\t\tcategory_id: 0,\r\n\t\t\t\t\tcover: \"\",\r\n\t\t\t\t\tcreated_time: \"\",\r\n\t\t\t\t\tdanmu_count: 0,\r\n\t\t\t\t\tdesc: \"\",\r\n\t\t\t\t\tduration: 0,\r\n\t\t\t\t\tid: 0,\r\n\t\t\t\t\tplay_count: 0,\r\n\t\t\t\t\ttitle: \"\",\r\n\t\t\t\t\tuser: {\r\n\t\t\t\t\t\tid: 0, \r\n\t\t\t\t\t\tusername: \"\", \r\n\t\t\t\t\t\tnickname: \"\", \r\n\t\t\t\t\t\tavatar: \"\",\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tvideos:[],\r\n\t\t\t\tscrollH:500,\r\n\t\t\t\thot:[],\r\n\t\t\t\tcomments:[],\r\n\t\t\t\tfollowStatus:false,\n\t\t\t\tfavaStatus:false,\r\n\t\t\t\t\r\n\t\t\t\tcontent:\"\",\r\n\t\t\t\treply_id:0,\r\n\t\t\t\treply_user:{\r\n\t\t\t\t\tid:0,\r\n\t\t\t\t\tname:\"\"\r\n\t\t\t\t},\r\n\t\t\t\tfensCount:0\n\t\t\t}\n\t\t},\r\n\t\tfilters: {\r\n\t\t\tformatTime(value) {\r\n\t\t\t\treturn $T.gettime(value);\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLoad(e) {\r\n\t\t\tlet res = uni.getSystemInfoSync()\r\n\t\t\tthis.scrollH = res.windowHeight - 226\r\n\t\t\t\r\n\t\t\tif(!e.id){\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: '非法参数',\r\n\t\t\t\t\ticon: 'none'\r\n\t\t\t\t});\r\n\t\t\t\treturn uni.navigateBack({\r\n\t\t\t\t\tdelta: 1\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis.id = e.id\r\n\t\t\t\r\n\t\t\tthis.$H.get('/video_read/'+this.id,{\r\n\t\t\t\ttoken:true,\r\n\t\t\t\tnoJump:true,\r\n\t\t\t\ttoast:false\r\n\t\t\t}).then(result=>{\r\n\t\t\t\tconsole.log(result);\r\n\t\t\t\tthis.hot = result.hot\r\n\t\t\t\tthis.detail = result.video\r\n\t\t\t\tthis.poster = this.detail.cover\r\n\t\t\t\tthis.videos = result.video.video_details || []\r\n\t\t\t\t\r\n\t\t\t\tif(this.videos.length === 0){\r\n\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\ttitle:\"提示\",\r\n\t\t\t\t\t\tcontent: '该作品的作者没有上传视频，所以无法播放',\r\n\t\t\t\t\t\tshowCancel:false,\r\n\t\t\t\t\t\tsuccess: (res)=> {\r\n\t\t\t\t\t\t\tuni.navigateBack({\r\n\t\t\t\t\t\t\t\tdelta: 1\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tthis.detail.created_time = $T.gettime(this.detail.created_time)\r\n\t\t\t\t\r\n\t\t\t\tthis.src = this.videos[this.activeIndex] ? this.videos[this.activeIndex].url : '' \r\n\t\t\t\t\r\n\t\t\t\tuni.$emit('video',{\r\n\t\t\t\t\tevent:\"init\",\r\n\t\t\t\t\tparams:{\r\n\t\t\t\t\t\tvideos:this.videos,\r\n\t\t\t\t\t\tactiveIndex:this.activeIndex,\r\n\t\t\t\t\t\tposter:this.detail.cover\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tthis.followStatus = result.follow\r\n\t\t\t\tthis.favaStatus = result.fava\r\n\t\t\t\t\r\n\t\t\t\tthis.getComments()\r\n\t\t\t\t\r\n\t\t\t\tthis.getUserInfo()\r\n\t\t\t})\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\tvideoCTX = uni.createVideoContext('myVideo',this)\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\t...mapState({\r\n\t\t\t\tuser_id:state=>{\r\n\t\t\t\t\treturn state.user ? state.user.id : 0\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\n\t\tmethods: {\r\n\t\t\tgetUserInfo(){\r\n\t\t\t\tthis.$H.get('/user/user_info?user_id='+this.detail.user.id).then(res=>{\r\n\t\t\t\t\tthis.fensCount = res.fensCount\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tgetComments(){\r\n\t\t\t\tthis.$H.get('/video_comment/'+this.detail.id).then(res=>{\r\n\t\t\t\t\tthis.comments = res\r\n\t\t\t\t\tconsole.log(res);\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tstop(){ },\r\n\t\t\t// 切换选项卡\n\t\t\tchangeTab(index){\r\n\t\t\t\tthis.tabIndex = index\r\n\t\t\t},\r\n\t\t\t// 弹出选集\r\n\t\t\topenPopup(){\r\n\t\t\t\tthis.$refs.popup.show()\r\n\t\t\t},\r\n\t\t\thidePopup(){\r\n\t\t\t\tthis.$refs.popup.hide()\r\n\t\t\t},\r\n\t\t\topenComment(reply_id = 0,reply_user = {\r\n\t\t\t\tid:0,\r\n\t\t\t\tusername:\"\",\r\n\t\t\t\tnickname:\"\"\r\n\t\t\t}){\r\n\t\t\t\tthis.reply_id = reply_id\r\n\t\t\t\tthis.reply_user = {\r\n\t\t\t\t\tid:reply_user.id,\r\n\t\t\t\t\tname:reply_user.nickname || reply_user.username\r\n\t\t\t\t}\r\n\t\t\t\tthis.content = ''\r\n\t\t\t\tthis.$refs.comment.show()\r\n\t\t\t},\r\n\t\t\t// 关注/取消关注\r\n\t\t\tdoFollow(){\r\n\t\t\t\tlet url = this.followStatus ? '/user/unfollow':'/user/follow'\r\n\t\t\t\tlet msg = this.followStatus ? '取消关注' : '关注'\r\n\t\t\t\tthis.$H.post(url,{\r\n\t\t\t\t\tfollow_id:this.detail.user.id\r\n\t\t\t\t},{\r\n\t\t\t\t\ttoken:true\r\n\t\t\t\t}).then(res=>{\r\n\t\t\t\t\tthis.followStatus = !this.followStatus\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: msg + '成功',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t\tconsole.log(res);\r\n\t\t\t\t}).catch(err=>{\r\n\t\t\t\t\tconsole.log(err);\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t// 收藏/取消收藏\r\n\t\t\tdoFava(){\r\n\t\t\t\tthis.$H.post('/fava/video',{\r\n\t\t\t\t\tvideo_id:this.detail.id\r\n\t\t\t\t},{\r\n\t\t\t\t\ttoken:true\r\n\t\t\t\t}).then(res=>{\r\n\t\t\t\t\tthis.favaStatus = res.status\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: res.msg,\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t// 提交评论内容\r\n\t\t\tsendComment(){\r\n\t\t\t\tif(this.content === ''){\r\n\t\t\t\t\treturn uni.showToast({\r\n\t\t\t\t\t\ttitle: '评论内容不能为空',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tthis.$H.post('/comment',{\r\n\t\t\t\t\tcontent:this.content,\r\n\t\t\t\t\tvideo_id:this.detail.id,\r\n\t\t\t\t\treply_id:this.reply_id,\r\n\t\t\t\t\treply_user_id:this.reply_user.id\r\n\t\t\t\t}).then(res=>{\r\n\t\t\t\t\tconsole.log(res);\r\n\t\t\t\t\tthis.getComments()\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '评论成功',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.$refs.comment.hide()\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tchangeVideo(item,index){\r\n\t\t\t\tvideoCTX.pause()\r\n\t\t\t\t\r\n\t\t\t\tthis.activeIndex = index\r\n\t\t\t\tthis.src = item.url\r\n\t\t\t\t\r\n\t\t\t\t// #ifndef APP-PLUS\r\n\t\t\t\tsetTimeout(()=>{\r\n\t\t\t\t\tvideoCTX.play()\r\n\t\t\t\t},300)\r\n\t\t\t\t// #endif\r\n\t\t\t\t// #ifdef APP-PLUS\r\n\t\t\t\tuni.$emit('video',{\r\n\t\t\t\t\tevent:\"change\",\r\n\t\t\t\t\tparams:{\r\n\t\t\t\t\t\tactiveIndex:this.activeIndex\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t// #endif\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\topenUserSpace(){\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: '../user-space/user-space?user_id='+this.detail.user.id,\r\n\t\t\t\t});\r\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style>\n\n</style>\n"],"sourceRoot":""}